include_directories(BEFORE
    include
    ${PROJECT_SOURCE_DIR}/host/host_tensor/include
    ${PROJECT_SOURCE_DIR}/host/device/include
    ${PROJECT_SOURCE_DIR}/host/solver/include
    ${PROJECT_SOURCE_DIR}/composable_kernel/include
    ${PROJECT_SOURCE_DIR}/composable_kernel/include/utility
    ${PROJECT_SOURCE_DIR}/composable_kernel/include/tensor_description
    ${PROJECT_SOURCE_DIR}/composable_kernel/include/tensor_operation
    ${PROJECT_SOURCE_DIR}/composable_kernel/include/problem_transform
    ${PROJECT_SOURCE_DIR}/composable_kernel/include/driver
    ${PROJECT_SOURCE_DIR}/external/rocm/include
)

set(CONV_FWD_DRIVER_OFFLINE_SOURCE src/conv_fwd_driver_offline.cpp)
set(CONV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE src/conv_fwd_driver_offline_nchwc.cpp)
set(CONV_BIAS_ACTIV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE src/conv_bias_activ_fwd_driver_offline_nchwc.cpp)
set(CONV_SOFTMAX_CONV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE src/conv_softmax_conv_fwd_driver_offline_nchwc.cpp)
set(CONV_DEPTH2SPACE_FWD_DRIVER_OFFLINE_NCHWC_SOURCE src/conv_depth2space_fwd_driver_offline_nchwc.cpp)
set(RESIZE_CONCAT_CONV_BIAS_ACTIV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE src/resize_concat_conv_bias_activ_fwd_driver_offline_nchwc.cpp)
set(CONV3x3_CONV1x1_FWD_DRIVER_OFFLINE_NCHWC_SOURCE src/conv3x3_conv1x1_fwd_driver_offline_nchwc.cpp)
set(GROUP_CONV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE src/group_conv_fwd_driver_offline_nchwc.cpp)
set(GROUP_CONV_BIAS_ACTIV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE src/group_conv_bias_activ_fwd_driver_offline_nchwc.cpp)
set(CONV_RESIZE_FWD_DRIVER_OFFLINE_NCHWC_SOURCE src/conv_resize_fwd_driver_offline_nchwc.cpp)
set(CONV_MAXPOOL_FWD_DRIVER_OFFLINE_NCHWC_SOURCE src/conv_maxpool_fwd_driver_offline_nchwc.cpp)
set(CONV_BWD_DRIVER_OFFLINE_SOURCE src/conv_bwd_driver_offline.cpp)
set(CONV_WRW_DRIVER_OFFLINE_SOURCE src/conv_wrw_driver_offline.cpp)
set(GEMM_DRIVER_OFFLINE_SOURCE src/gemm_driver_offline.cpp)

add_executable(conv_fwd_driver_offline ${CONV_FWD_DRIVER_OFFLINE_SOURCE})
add_executable(conv_fwd_driver_offline_nchwc ${CONV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE})
add_executable(conv_bias_activ_fwd_driver_offline_nchwc ${CONV_BIAS_ACTIV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE})
add_executable(conv_softmax_conv_fwd_driver_offline_nchwc ${CONV_SOFTMAX_CONV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE})
add_executable(conv_depth2space_fwd_driver_offline_nchwc ${CONV_DEPTH2SPACE_FWD_DRIVER_OFFLINE_NCHWC_SOURCE})
add_executable(resize_concat_conv_bias_activ_fwd_driver_offline_nchwc ${RESIZE_CONCAT_CONV_BIAS_ACTIV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE})
add_executable(conv3x3_conv1x1_fwd_driver_offline_nchwc ${CONV3x3_CONV1x1_FWD_DRIVER_OFFLINE_NCHWC_SOURCE})
add_executable(group_conv_fwd_driver_offline_nchwc ${GROUP_CONV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE})
add_executable(group_conv_bias_activ_fwd_driver_offline_nchwc ${GROUP_CONV_BIAS_ACTIV_FWD_DRIVER_OFFLINE_NCHWC_SOURCE})
add_executable(conv_resize_fwd_driver_offline_nchwc ${CONV_RESIZE_FWD_DRIVER_OFFLINE_NCHWC_SOURCE})
add_executable(conv_maxpool_fwd_driver_offline_nchwc ${CONV_MAXPOOL_FWD_DRIVER_OFFLINE_NCHWC_SOURCE})
add_executable(conv_bwd_driver_offline ${CONV_BWD_DRIVER_OFFLINE_SOURCE})
add_executable(conv_wrw_driver_offline ${CONV_WRW_DRIVER_OFFLINE_SOURCE})
add_executable(gemm_driver_offline ${GEMM_DRIVER_OFFLINE_SOURCE})

target_link_libraries(conv_fwd_driver_offline PRIVATE host_tensor)
target_link_libraries(conv_fwd_driver_offline_nchwc PRIVATE host_tensor)
target_link_libraries(conv_bias_activ_fwd_driver_offline_nchwc PRIVATE host_tensor)
target_link_libraries(conv_softmax_conv_fwd_driver_offline_nchwc PRIVATE host_tensor)
target_link_libraries(conv_depth2space_fwd_driver_offline_nchwc PRIVATE host_tensor)
target_link_libraries(resize_concat_conv_bias_activ_fwd_driver_offline_nchwc PRIVATE host_tensor)
target_link_libraries(conv3x3_conv1x1_fwd_driver_offline_nchwc PRIVATE host_tensor)
target_link_libraries(group_conv_fwd_driver_offline_nchwc PRIVATE host_tensor)
target_link_libraries(group_conv_bias_activ_fwd_driver_offline_nchwc PRIVATE host_tensor)
target_link_libraries(conv_resize_fwd_driver_offline_nchwc PRIVATE host_tensor)
target_link_libraries(conv_maxpool_fwd_driver_offline_nchwc PRIVATE host_tensor)
target_link_libraries(conv_bwd_driver_offline PRIVATE host_tensor)
target_link_libraries(conv_wrw_driver_offline PRIVATE host_tensor)
target_link_libraries(gemm_driver_offline PRIVATE host_tensor)
